---
title: "Exploratory Data Analysis"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    highlight: kate
    toc_depth: 3
    code_folding: "hide"
---


```{r knitr_init, echo=FALSE, cache=FALSE, message=FALSE}
library(knitr)
library(rmdformats)
library(dplyr)
library(ggplot2)
library(kableExtra)

## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
opts_knit$set(width=75)
```

```{r read_data}
training <- read.csv("../data/moneyball-training-data.csv")
```

### Summary Statistics

The following is a summary of the data.

```{r}
training %>% 
  select(-INDEX) %>%
  summary(.) %>%
  kable() %>%
  kable_styling()
```

### Variable Distributions

The following density plots show the spread of the data.  The red verticle line is the mean and the blue verticle line is the median.

```{r}
density_plot <- function(d, title, xlab, ylab){
  nas <- d %>% filter(is.na(x)) %>% nrow()
  p <- ggplot(d, aes(x, stat(count))) +
    geom_density() +
    labs(title = title, 
       x = xlab,
       y = ylab) +
    theme(panel.background = element_blank(),
        panel.grid.major = element_line(color = "gray95")) +
    geom_vline(xintercept = mean(d$x, na.rm = TRUE), color = "red") +
    geom_vline(xintercept = median(d$x, na.rm = TRUE), color = "blue")
  # Add annotation for NA's
  if(nas > 0){
    p <- p + ggtitle(title, subtitle = paste(nas, "Null Observations")) 
  }
  p
}
```

```{r}
training %>%
  mutate(x = TARGET_WINS) %>%
  density_plot(., "Wins", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BATTING_H) %>%
  density_plot(., "Base Hits", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BATTING_2B) %>%
  density_plot(., "Doubles", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BATTING_3B) %>%
  density_plot(., "Triples", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BATTING_HR) %>%
  density_plot(., "Homeruns", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BATTING_BB) %>%
  density_plot(., "Walks", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BATTING_HBP) %>%
  density_plot(., "Batters Hit by Pitch", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BATTING_SO) %>%
  density_plot(., "Strikeouts", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BASERUN_SB) %>%
  density_plot(., "Stolen Bases", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_BASERUN_CS) %>%
  density_plot(., "Caught Stealing Bases", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_FIELDING_E) %>%
  density_plot(., "Errors", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_FIELDING_DP) %>%
  density_plot(., "Double Plays", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_PITCHING_BB) %>%
  density_plot(., "Walks Allowed", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_PITCHING_H) %>%
  density_plot(., "Hits Allowed", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_PITCHING_HR) %>%
  density_plot(., "Homeruns Allowed", element_blank(), element_blank())
```

```{r}
training %>%
  mutate(x = TEAM_PITCHING_SO) %>%
  density_plot(., "Strikouts by Pitcher", element_blank(), element_blank())
```